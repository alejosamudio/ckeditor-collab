@import url('https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,400;0,700;1,400;1,700&display=swap');

@media print {
	body {
		margin: 0 !important;
	}
}

:root {
	--ck-content-font-family: 'Lato';
	--ck-sidebar-width: 270px;
	--ck-editor-height: 100%;
	
	/* Modern color palette */
	--modern-bg: #f8f9fa;
	--modern-surface: #ffffff;
	--modern-border: #e1e4e8;
	--modern-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
	--modern-shadow-lg: 0 4px 20px rgba(0, 0, 0, 0.12);
	--modern-accent: #4f46e5;
	
	/* Document dimensions */
	--doc-base-width: 210mm;
	--doc-max-width: 210mm;
}

/* Larger document on big screens */
@media (min-width: 1920px) {
	:root {
		--doc-max-width: 240mm;
	}
}

@media (min-width: 2560px) {
	:root {
		--doc-max-width: 260mm;
	}
}

body {
	background: var(--modern-bg) !important;
}

.main-container {
	font-family: var(--ck-content-font-family);
	width: fit-content;
	max-width: 100vw;
	margin-left: auto;
	margin-right: auto;
}

.main-container .presence {
	margin-bottom: 12px;
}

.editor-container__editor-wrapper {
	display: flex;
	width: fit-content;
	justify-content: center;
}

.editor-container_document-editor {
	border: 1px solid var(--modern-border);
	border-radius: 12px;
	overflow: hidden;
	background: var(--modern-surface);
	box-shadow: var(--modern-shadow-lg);
	width: fit-content;
	max-width: 100vw;
}

.editor-container_document-editor .editor-container__toolbar {
	display: flex;
	position: relative;
	background: var(--modern-surface);
	border-bottom: 1px solid var(--modern-border);
}

.editor-container_document-editor .editor-container__toolbar > .ck.ck-toolbar {
	flex-grow: 1;
	width: 0;
	border: none !important;
	background: var(--modern-surface);
	border-radius: 0;
	padding: 8px 12px;
}

.editor-container_document-editor .editor-container__menu-bar > .ck.ck-menu-bar {
	border: none !important;
	background: var(--modern-surface);
	border-radius: 0;
	border-bottom: 1px solid var(--modern-border);
}

.editor-container_document-editor .editor-container__editor-wrapper {
	max-height: var(--ck-editor-height);
	min-height: var(--ck-editor-height);
	overflow-y: scroll;
	background: linear-gradient(to bottom, #fafbfc 0%, #f5f6f7 100%);
	scrollbar-width: thin;
	scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
	display: flex;
	justify-content: center;
	width: fit-content;
}

/* Modern scrollbar for Webkit browsers */
.editor-container_document-editor .editor-container__editor-wrapper::-webkit-scrollbar {
	width: 8px;
}

.editor-container_document-editor .editor-container__editor-wrapper::-webkit-scrollbar-track {
	background: transparent;
}

.editor-container_document-editor .editor-container__editor-wrapper::-webkit-scrollbar-thumb {
	background: rgba(0, 0, 0, 0.2);
	border-radius: 4px;
}

.editor-container_document-editor .editor-container__editor-wrapper::-webkit-scrollbar-thumb:hover {
	background: rgba(0, 0, 0, 0.3);
}

.editor-container_document-editor .editor-container__editor {
	margin-top: 32px;
	margin-bottom: 32px;
	height: 100%;
	display: flex;
	justify-content: center;
	width: fit-content;
}

.editor-container_document-editor .editor-container__editor .ck.ck-editor__editable {
	box-sizing: border-box;
	min-width: var(--doc-base-width);
	max-width: var(--doc-max-width);
	width: 100%;
	min-height: 297mm;
	height: fit-content;
	padding: 20mm 12mm;
	border: 1px solid var(--modern-border);
	background: var(--modern-surface);
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 
	            0 8px 24px rgba(0, 0, 0, 0.08);
	flex: 0 0 auto;
	margin-left: 72px;
	margin-right: 72px;
	border-radius: 4px;
	transition: box-shadow 0.2s ease, max-width 0.3s ease, margin 0.3s ease;
}

/* When AI panel is open - adjust margins for better centering */
.editor-container_document-editor:has(.ck-ai-tabs__overlay) .editor-container__editor .ck.ck-editor__editable {
	margin-left: 40px;
	margin-right: 40px;
}

/* On larger screens with AI panel open, keep document centered nicely */
@media (min-width: 1600px) {
	.editor-container_document-editor:has(.ck-ai-tabs__overlay) .editor-container__editor .ck.ck-editor__editable {
		margin-left: 60px;
		margin-right: 60px;
	}
}

@media (min-width: 1920px) {
	.editor-container_document-editor:has(.ck-ai-tabs__overlay) .editor-container__editor .ck.ck-editor__editable {
		margin-left: 80px;
		margin-right: 80px;
	}
}

/* When AI panel is closed - symmetric margins */
.editor-container_document-editor:not(:has(.ck-ai-tabs__overlay)) .editor-container__editor .ck.ck-editor__editable {
	margin-left: 72px;
	margin-right: 72px;
}

.editor-container_document-editor .editor-container__editor .ck.ck-editor__editable:focus {
	box-shadow: 0 1px 3px rgba(0, 0, 0, 0.06), 
	            0 12px 32px rgba(0, 0, 0, 0.12);
}

.editor-container_include-annotations .editor-container__editor .ck.ck-editor__editable {
	margin-right: 0;
}

.editor-container__sidebar {
	min-width: var(--ck-sidebar-width);
	max-width: var(--ck-sidebar-width);
	margin-top: 28px;
	margin-left: 10px;
	margin-right: 10px;
}

/* Modern toolbar buttons */
.ck.ck-toolbar .ck.ck-button {
	border-radius: 6px;
	transition: all 0.15s ease;
}

.ck.ck-toolbar .ck.ck-button:hover {
	background: rgba(79, 70, 229, 0.08);
}

.ck.ck-toolbar .ck.ck-button.ck-on {
	background: rgba(79, 70, 229, 0.12);
}

/* Modern dropdown styling */
.ck.ck-dropdown__panel {
	border-radius: 8px;
	border: 1px solid var(--modern-border);
	box-shadow: var(--modern-shadow-lg);
}

/* AI Chat Sidebar - Modern styling with controlled z-index */
.ck.ck-tabs.ck-ai-tabs.ck-ai-tabs__overlay.ck-tabs_right {
    width: min(28vw, 400px) !important;
    max-width: 400px !important;
    border-left: 1px solid var(--modern-border);
    background: var(--modern-surface);
    box-shadow: -2px 0 12px rgba(0, 0, 0, 0.06);
    transition: width 0.3s ease, max-width 0.3s ease;
    z-index: 100 !important; /* Lower than comments/balloons */
}

/* Medium screens (tablets, small laptops) */
@media (min-width: 1024px) {
    .ck.ck-tabs.ck-ai-tabs.ck-ai-tabs__overlay.ck-tabs_right {
        width: min(30vw, 480px) !important;
        max-width: 480px !important;
    }
}

/* Large screens (desktops) */
@media (min-width: 1440px) {
    .ck.ck-tabs.ck-ai-tabs.ck-ai-tabs__overlay.ck-tabs_right {
        width: min(32vw, 550px) !important;
        max-width: 550px !important;
    }
}

/* Extra large screens */
@media (min-width: 1920px) {
    .ck.ck-tabs.ck-ai-tabs.ck-ai-tabs__overlay.ck-tabs_right {
        width: min(35vw, 650px) !important;
        max-width: 650px !important;
    }
}

/* Modern AI chat header */
.ck.ck-ai-tabs .ck-tabs__header {
	border-bottom: 1px solid var(--modern-border);
	background: var(--modern-surface);
	padding: 8px;
}

/* Modern AI chat messages */
.ck.ck-ai-chat__message {
	border-radius: 8px;
	margin-bottom: 8px;
}

/* Modern comments sidebar */
.ck.ck-sidebar {
	background: var(--modern-surface);
	border-left: 1px solid var(--modern-border);
	border-radius: 0;
}

.ck.ck-annotation {
	border-radius: 8px;
	margin-bottom: 8px;
	transition: all 0.15s ease;
}

.ck.ck-annotation:hover {
	box-shadow: var(--modern-shadow);
}

/* Fix AI Chat input overflowing */
.ck.ck-labeled-field-view > .ck.ck-labeled-field-view__input-wrapper {
    overflow: auto !important;
}

/* Modern input fields */
.ck.ck-input {
	border-radius: 6px;
	border: 1px solid var(--modern-border);
	transition: all 0.15s ease;
}

.ck.ck-input:focus {
	border-color: var(--modern-accent);
	box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}

/* Modern buttons */
.ck.ck-button:not(.ck-button_with-text) {
	border-radius: 6px;
}

/* Hide CKEditor branding for cleaner look */
.ck.ck-powered-by {
	display: none !important;
}

/* Smooth transitions for panels */
.ck.ck-balloon-panel {
	border-radius: 8px;
	border: 1px solid var(--modern-border);
	box-shadow: var(--modern-shadow-lg);
}

/* CRITICAL FIX: Ensure comment balloons/annotations appear ABOVE AI panel */
.ck.ck-balloon-panel,
.ck-balloon-panel,
.ck.ck-annotation-wrapper,
.ck-annotation-wrapper,
.ck.ck-comment-thread,
.ck-comment-thread {
	z-index: 9999 !important; /* Much higher than AI panel (100) */
}

/* Ensure balloon toolbar appears above everything */
.ck.ck-balloon-panel.ck-toolbar-container,
.ck.ck-balloon-panel_with-arrow {
	z-index: 10000 !important;
}

/* Comment input and UI elements */
.ck.ck-annotation__wrapper,
.ck-annotation__wrapper {
	z-index: 9999 !important;
}

/* Inline comment markers should be visible */
.ck-comment-marker {
	z-index: 1 !important;
	position: relative;
}

/* ============================================================
   CUSTOM COMMENT THREAD VIEW STYLES
   ============================================================ */

/* Hide the placeholder when no dropdown yet */
.ck-thread-top-bar-placeholder {
	display: none;
}

/* Top bar containing the Actions dropdown */
.ck-thread-top-bar {
	padding: 6px 8px;
	background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
	text-align: right;
	border-radius: 8px 8px 0 0;
	margin: -1px -1px 0 -1px;
}

/* Style the Actions dropdown button */
.ck-thread-top-bar .ck-dropdown__button {
	background: rgba(255, 255, 255, 0.2) !important;
	border: 1px solid rgba(255, 255, 255, 0.3) !important;
	border-radius: 4px !important;
	color: white !important;
	font-size: 12px !important;
	padding: 4px 10px !important;
	min-height: auto !important;
	transition: all 0.2s ease !important;
}

.ck-thread-top-bar .ck-dropdown__button:hover {
	background: rgba(255, 255, 255, 0.3) !important;
}

.ck-thread-top-bar .ck-dropdown__button .ck-button__label {
	color: white !important;
	font-weight: 500 !important;
}

.ck-thread-top-bar .ck-dropdown__arrow {
	color: white !important;
}

/* Dropdown panel styling */
.ck-thread-top-bar .ck-dropdown__panel {
	border-radius: 6px !important;
	box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
	overflow: hidden !important;
	z-index: 10001 !important;
	min-width: 150px !important;
}

/* ListView inside dropdown */
.ck-thread-top-bar .ck-list {
	padding: 4px 0 !important;
}

/* List items */
.ck-thread-top-bar .ck-list-item-button {
	padding: 8px 16px !important;
	width: 100% !important;
	justify-content: flex-start !important;
}

.ck-thread-top-bar .ck-list-item-button:hover {
	background: #f0f0f5 !important;
}

/* Style the Fix with AI option specially */
.ck-thread-top-bar .ck-list__item:first-child .ck-button__label {
	background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
	-webkit-background-clip: text;
	-webkit-text-fill-color: transparent;
	background-clip: text;
	font-weight: 600 !important;
}

/* Active thread highlight */
.ck.ck-thread.ck-thread--active .ck-thread-top-bar {
	background: linear-gradient(135deg, #5a67d8 0%, #6b46c1 100%);
}